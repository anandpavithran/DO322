"nexus-registry-int.apps.tools-na.prod.nextcle.com":
{"auth":"cmVndXNlcjpJbnN0YWxsTTM=","email":"nobody@example.com"}


cat pull-secret.json | jq . -c > pull-secret-oneline.json
scp pull-secret-oneline.json lab@utility:
ocp_maj=4.6;rhcos_ver=4.6.1
mirror=https://mirror.openshift.com/pub/openshift-v4
baseurl=${mirror}/dependencies/rhcos/${ocp_maj}/${rhcos_ver}
cd /var/www/html/openshift4/images/
wget ${baseurl}/rhcos-${rhcos_ver}-x86_64-live-rootfs.x86_64.img
wget ${baseurl}/rhcos-${rhcos_ver}-x86_64-live-kernel-x86_64
wget ${baseurl}/rhcos-${rhcos_ver}-x86_64-live-initramfs.x86_64.img
wget http://classroom.example.com/materials/solutions/haproxy/haproxy.cfg
sol_url=http://classroom.example.com/materials/solutions
wget $sol_url/pxelinux.cfg/01-52-54-00-00-32-09 -P /var/lib/tftpboot/pxelinux.cfg/

mkdir ocp4upi && cd ocp4upi
wget http://classroom.example.com/materials/solutions/ocp4upi/install-config.yaml
reg="nexus-registry-int.apps.tools-na.prod.nextcle.com"
releaseimg="/openshift/ocp4:4.6.4-x86_64"
export OPENSHIFT_INSTALL_RELEASE_IMAGE_OVERRIDE=$reg$releaseimg

cp install-config.yaml /home/lab/

openshift-install create ignition-configs --dir=.

sudo cp *.ign /var/www/html/openshift4/4.6.4/ignitions/
sudo chmod +r /var/www/html/openshift4/4.6.4/ignitions/*.ign
openshift-install --dir=./ocp4upi wait-for bootstrap-complete

export KUBECONFIG=~/ocp4upi/auth/kubeconfig
openshift-install --dir=ocp4upi wait-for install-complete  --log-level=debug
oc get csr -o go-template='{{range .items}}{{if not .status}}{{.metadata.name}}{{"\n"}}{{end}}{{end}}' | xargs oc adm certificate approve
